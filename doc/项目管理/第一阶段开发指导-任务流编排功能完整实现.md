# ç¬¬ä¸€é˜¶æ®µå¼€å‘æŒ‡å¯¼ï¼šä»»åŠ¡æµç¼–æ’åŠŸèƒ½å®Œæ•´å®ç°

## å¼€å‘ç›®æ ‡

åŸºäºç°æœ‰çš„`TrainingStagePanel`ã€`TaskTypeSelector`å’Œ`TaskList`ç»„ä»¶ï¼Œå®Œå–„ä»»åŠ¡æµç¼–æ’çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’ŒåŠŸèƒ½å®Œæ•´æ€§ã€‚

## å½“å‰çŠ¶å†µåˆ†æ

### âœ… å·²å®ŒæˆåŠŸèƒ½
- âœ… åŸºç¡€é˜¶æ®µç®¡ç†ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰
- âœ… ä»»åŠ¡ç±»å‹åˆ†ç»„å±•ç¤ºï¼ˆonline/offline/toolï¼‰
- âœ… ä»»åŠ¡åˆ›å»ºå’ŒåŸºæœ¬ç¼–è¾‘
- âœ… ä»»åŠ¡ç¼–è¾‘æ³¨å†Œè¡¨æœºåˆ¶
- âœ… åŸºç¡€çš„ä»»åŠ¡åˆ—è¡¨å±•ç¤º

### ğŸ”„ éœ€è¦ä¼˜åŒ–çš„åŠŸèƒ½
- ğŸ”„ ä»»åŠ¡æ‹–æ‹½æ’åº
- ğŸ”„ ä»»åŠ¡æ‰¹é‡æ“ä½œ
- ğŸ”„ é˜¶æ®µé—´ä»»åŠ¡ç§»åŠ¨
- ğŸ”„ ä»»åŠ¡ç±»å‹å…ƒæ•°æ®ç®¡ç†
- ğŸ”„ é˜¶æ®µæ¨¡æ¿åŠŸèƒ½

## å¼€å‘ä»»åŠ¡æ¸…å•

### Week 1-2: ä»»åŠ¡ç±»å‹ç®¡ç†ä¼˜åŒ–

#### ä»»åŠ¡1.1: å¢å¼ºä»»åŠ¡ç±»å‹å®šä¹‰
**ç›®æ ‡**: ä¸º`taskTypeCategories.ts`æ·»åŠ æ›´ä¸°å¯Œçš„å…ƒæ•°æ®

```typescript
// ä¿®æ”¹ training-system-frontend/src/modules/project-management/constants/taskTypeCategories.ts
export interface TaskTypeConfig {
  type: string;
  label: string;
  icon: Component;
  color: string;
  category: 'online' | 'offline' | 'tool';
  description?: string;
  defaultConfig?: Record<string, any>;
  estimatedDuration?: number; // é¢„ä¼°æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
}

export const ENHANCED_TASK_TYPES: TaskTypeConfig[] = [
  {
    type: 'face-to-face',
    label: 'é¢æˆ',
    icon: User,
    color: '#409EFF',
    category: 'offline',
    description: 'çº¿ä¸‹é¢æˆè¯¾ç¨‹',
    defaultConfig: { duration: 120 },
    estimatedDuration: 120
  },
  // ... å…¶ä»–ä»»åŠ¡ç±»å‹
];
```

#### ä»»åŠ¡1.2: åŠ¨æ€å›¾æ ‡å’Œé¢œè‰²ç®¡ç†
**ç›®æ ‡**: å°†å›¾æ ‡æ˜ å°„ä»ç»„ä»¶ä¸­æå–åˆ°é…ç½®æ–‡ä»¶

```typescript
// æ–°å»ºæ–‡ä»¶: constants/taskTypeIcons.ts
import { User, Edit, Reading, Timer } from '@element-plus/icons-vue';

export const TASK_TYPE_ICONS: Record<string, any> = {
  'face-to-face': User,
  'homework': Edit,
  'online-course': Reading,
  'attendance': Timer,
  // ... å…¶ä»–å›¾æ ‡æ˜ å°„
};

export const TASK_TYPE_COLORS: Record<string, string> = {
  'face-to-face': '#409EFF',
  'homework': '#67C23A',
  'online-course': '#E6A23C',
  'attendance': '#F56C6C',
};
```

### Week 3-4: ä»»åŠ¡æµç¼–è¾‘å™¨å¢å¼º

#### ä»»åŠ¡2.1: å®ç°ä»»åŠ¡æ‹–æ‹½æ’åº
**ç›®æ ‡**: åœ¨`TaskList.vue`ä¸­å®ç°ä»»åŠ¡çš„æ‹–æ‹½æ’åºåŠŸèƒ½

```vue
<!-- ä¿®æ”¹ TaskList.vue -->
<template>
  <el-table 
    :data="filteredTasks" 
    border 
    stripe 
    size="small"
    row-key="id"
    @row-drop="handleTaskReorder"
  >
    <!-- ç°æœ‰åˆ—... -->
  </el-table>
</template>

<script setup lang="ts">
import Sortable from 'sortablejs';

// æ·»åŠ æ‹–æ‹½æ’åºåŠŸèƒ½
function handleTaskReorder(evt: any) {
  const { oldIndex, newIndex } = evt;
  if (!currentStage.value) return;
  
  const tasks = currentStage.value.tasks;
  const [movedTask] = tasks.splice(oldIndex, 1);
  tasks.splice(newIndex, 0, movedTask);
  
  // æ›´æ–°orderå­—æ®µ
  tasks.forEach((task, index) => {
    task.order = index;
  });
}
</script>
```

#### ä»»åŠ¡2.2: ä»»åŠ¡æ‰¹é‡æ“ä½œåŠŸèƒ½
**ç›®æ ‡**: æ·»åŠ ä»»åŠ¡çš„æ‰¹é‡é€‰æ‹©ã€åˆ é™¤ã€ç§»åŠ¨åŠŸèƒ½

```vue
<!-- åœ¨ TaskList.vue ä¸­æ·»åŠ æ‰¹é‡æ“ä½œ -->
<template>
  <div class="task-list">
    <!-- æ‰¹é‡æ“ä½œå·¥å…·æ  -->
    <div v-if="selectedTasks.length > 0" class="batch-toolbar">
      <el-button size="small" @click="batchDelete">æ‰¹é‡åˆ é™¤</el-button>
      <el-button size="small" @click="batchMove">æ‰¹é‡ç§»åŠ¨</el-button>
      <el-button size="small" @click="batchCopy">æ‰¹é‡å¤åˆ¶</el-button>
    </div>
    
    <el-table 
      :data="filteredTasks"
      @selection-change="handleSelectionChange"
    >
      <el-table-column type="selection" width="55" />
      <!-- å…¶ä»–åˆ—... -->
    </el-table>
  </div>
</template>
```

### Week 5-6: é˜¶æ®µç®¡ç†å®Œå–„

#### ä»»åŠ¡3.1: é˜¶æ®µé—´ä»»åŠ¡ç§»åŠ¨
**ç›®æ ‡**: å®ç°ä»»åŠ¡åœ¨ä¸åŒé˜¶æ®µé—´çš„ç§»åŠ¨å’Œå¤åˆ¶

```typescript
// åœ¨ trainingStage.ts ä¸­æ·»åŠ æ–°æ–¹æ³•
function moveTaskBetweenStages(taskId: string, fromStageId: string, toStageId: string) {
  const fromStage = stages.value.find(s => s.id === fromStageId);
  const toStage = stages.value.find(s => s.id === toStageId);
  
  if (!fromStage || !toStage) return;
  
  const taskIndex = fromStage.tasks.findIndex(t => t.id === taskId);
  if (taskIndex === -1) return;
  
  const [task] = fromStage.tasks.splice(taskIndex, 1);
  task.order = toStage.tasks.length;
  toStage.tasks.push(task);
}

function duplicateTask(taskId: string) {
  const task = findTaskById(taskId);
  if (!task) return;
  
  const newTask: Task = {
    ...task,
    id: nanoid(),
    name: `${task.name} (å‰¯æœ¬)`,
    order: task.order + 1
  };
  
  addTaskToStage(newTask, activeStageId.value);
}
```

#### ä»»åŠ¡3.2: é˜¶æ®µæ¨¡æ¿åŠŸèƒ½
**ç›®æ ‡**: å…è®¸ç”¨æˆ·ä¿å­˜å’Œåº”ç”¨é˜¶æ®µæ¨¡æ¿

```typescript
// æ–°å»ºæ–‡ä»¶: types/stageTemplate.ts
export interface StageTemplate {
  id: string;
  name: string;
  description?: string;
  tasks: Omit<Task, 'id'>[];
  category: 'default' | 'custom';
}

// åœ¨ trainingStage.ts ä¸­æ·»åŠ æ¨¡æ¿ç›¸å…³æ–¹æ³•
function saveStageAsTemplate(stageId: string, templateName: string) {
  const stage = stages.value.find(s => s.id === stageId);
  if (!stage) return;
  
  const template: StageTemplate = {
    id: nanoid(),
    name: templateName,
    tasks: stage.tasks.map(({ id, ...task }) => task),
    category: 'custom'
  };
  
  // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨æˆ–å‘é€åˆ°åç«¯
  saveTemplate(template);
}

function applyTemplate(templateId: string, targetStageId?: string) {
  const template = getTemplateById(templateId);
  if (!template) return;
  
  const stageId = targetStageId || activeStageId.value;
  const stage = stages.value.find(s => s.id === stageId);
  if (!stage) return;
  
  // æ¸…ç©ºç°æœ‰ä»»åŠ¡å¹¶åº”ç”¨æ¨¡æ¿
  stage.tasks = template.tasks.map(task => ({
    ...task,
    id: nanoid()
  }));
}
```

## å®ç°ä¼˜å…ˆçº§

1. **é«˜ä¼˜å…ˆçº§ï¼ˆå¿…é¡»å®Œæˆï¼‰**
   - ä»»åŠ¡æ‹–æ‹½æ’åº
   - ä»»åŠ¡æ‰¹é‡æ“ä½œ
   - å¢å¼ºçš„ä»»åŠ¡ç±»å‹å®šä¹‰

2. **ä¸­ä¼˜å…ˆçº§ï¼ˆå»ºè®®å®Œæˆï¼‰**
   - é˜¶æ®µé—´ä»»åŠ¡ç§»åŠ¨
   - åŠ¨æ€å›¾æ ‡å’Œé¢œè‰²ç®¡ç†

3. **ä½ä¼˜å…ˆçº§ï¼ˆæ—¶é—´å…è®¸æ—¶å®Œæˆï¼‰**
   - é˜¶æ®µæ¨¡æ¿åŠŸèƒ½
   - ä»»åŠ¡ç»Ÿè®¡å’Œåˆ†æ

## æŠ€æœ¯è¦ç‚¹

### æ‹–æ‹½å®ç°
- ä½¿ç”¨`sortablejs`åº“å®ç°è¡¨æ ¼è¡Œçš„æ‹–æ‹½
- ç¡®ä¿æ‹–æ‹½åæ­£ç¡®æ›´æ–°ä»»åŠ¡çš„`order`å­—æ®µ
- æä¾›æ‹–æ‹½æ—¶çš„è§†è§‰åé¦ˆ

### çŠ¶æ€ç®¡ç†
- æ‰€æœ‰æ“ä½œéƒ½è¦åŒæ­¥æ›´æ–°Storeä¸­çš„æ•°æ®
- è€ƒè™‘æ·»åŠ æ“ä½œå†å²è®°å½•ä»¥æ”¯æŒæ’¤é”€åŠŸèƒ½
- ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§

### ç”¨æˆ·ä½“éªŒ
- æ“ä½œç¡®è®¤ï¼šåˆ é™¤ã€ç§»åŠ¨ç­‰é‡è¦æ“ä½œéœ€è¦ç”¨æˆ·ç¡®è®¤
- åŠ è½½çŠ¶æ€ï¼šæ‰¹é‡æ“ä½œæ—¶æ˜¾ç¤ºè¿›åº¦æŒ‡ç¤ºå™¨
- é”™è¯¯å¤„ç†ï¼šæ“ä½œå¤±è´¥æ—¶ç»™å‡ºæ˜ç¡®çš„é”™è¯¯æç¤º

## æµ‹è¯•è®¡åˆ’

1. **åŠŸèƒ½æµ‹è¯•**
   - æ‹–æ‹½æ’åºåŠŸèƒ½çš„å‡†ç¡®æ€§
   - æ‰¹é‡æ“ä½œçš„æ­£ç¡®æ€§
   - é˜¶æ®µé—´ç§»åŠ¨çš„æ•°æ®å®Œæ•´æ€§

2. **ç”¨æˆ·ä½“éªŒæµ‹è¯•**
   - æ“ä½œçš„ç›´è§‚æ€§å’Œæ˜“ç”¨æ€§
   - å“åº”é€Ÿåº¦å’Œæ€§èƒ½
   - é”™è¯¯å¤„ç†çš„å‹å¥½æ€§

3. **å…¼å®¹æ€§æµ‹è¯•**
   - ä¸åŒæµè§ˆå™¨çš„å…¼å®¹æ€§
   - ç§»åŠ¨ç«¯çš„è§¦æ‘¸æ“ä½œæ”¯æŒ

## åç»­é›†æˆ

å®Œæˆæœ¬é˜¶æ®µåï¼Œéœ€è¦ï¼š
1. ä¸åç«¯APIé›†æˆï¼ŒæŒä¹…åŒ–ä»»åŠ¡æµæ•°æ®
2. æ·»åŠ ä»»åŠ¡æµçš„ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½
3. å®ç°ä»»åŠ¡æµçš„å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
4. ä¸ºä¸‹ä¸€é˜¶æ®µçš„é¢æˆã€ä½œä¸šã€çº¿ä¸Šè¯¾ç¨‹ç•Œé¢å¼€å‘åšå¥½å‡†å¤‡

---

*å¼€å‘å‘¨æœŸï¼š4-6å‘¨*  
*è´Ÿè´£äººï¼šå‰ç«¯å¼€å‘å›¢é˜Ÿ*  
*è¯„å®¡æ—¶é—´ï¼šæ¯å‘¨äº”ä¸‹åˆ* 